package blueTooth;

import java.io.IOException;
import java.io.OutputStream;

import lejos.nxt.Button;
import lejos.nxt.SensorPort;
import lejos.nxt.SensorPortListener;
import lejos.nxt.UltrasonicSensor;
import lejos.nxt.comm.Bluetooth;
import lejos.nxt.comm.NXTConnection;

public class NXTSideBluetooth {

	public static void main(String[] args){
		NXTSideBluetooth transmit = new NXTSideBluetooth();
		transmit.run();
	}
	
	private NXTConnection connection;
	private OutputStream os;

	public void run(){
		System.out.println("Start Connection");
		Button.waitForAnyPress();
		connection = Bluetooth.waitForConnection();
		System.out.println("Connection");
		os = connection.openOutputStream();
		UltrasonicSensor sensor = new UltrasonicSensor(SensorPort.S1);
		sensor.ping();
		int[] distances = new int[8];
		sensor.getDistances(distances);
		System.out.println("Waiting for input.");
		Button.waitForAnyPress();
	}
	
	public void sendDistances(int[] distances){
		for(int i : distances){
			try {
				os.write(i);
				os.flush();
			} catch (IOException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			
		}
	}
	
//	private class UltraSonicListener implements SensorPortListener{
//
//		@Override
//		public void stateChanged(SensorPort arg0, int arg1, int arg2) {
//			try {
//				String message = ("Old Arg: " + arg1 + ", New Arg: " + arg2 + "\n");
//				os.write(message.getBytes());
//				os.flush();
//			} catch (IOException e) {
//				// TODO Auto-generated catch block
//				e.printStackTrace();
//			}
//			
//		}
//	}
	
}
